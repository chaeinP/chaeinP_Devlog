---
title: C_κ³µμ©μ²΄
date: '2021-10-01'
tags: ['C']
draft: false
summary: κ³µμ©μ²΄ μ΄λ΅ λ¶€ν„° ν™μ© μμ κΉμ§€
---

> μ΄ ν¬μ¤νΈλ” [μ½”λ”© λ„μ¥-Cμ–Έμ–΄](https://dojang.io)μ„ λ³΄κ³  μ •λ¦¬ν• study log μ…λ‹λ‹¤. λ³΄λ‹¤ μμ„Έν• λ‚΄μ©μ€ λ§ν¬μ—μ„ ν™•μΈν•μ‹¤ μ μμµλ‹λ‹¤.

## κ³µμ©μ²΄ union

κ³µμ©μ²΄λ” κµ¬μ΅°μ²΄μ™€ μ •μ λ°©λ²•μ΄ κ°™μ§€λ§ **λ¨λ“  λ©¤λ²„κ°€ λ©¤λ²„ μ¤‘ κ°€μ¥ ν° μλ£ν•μ κ³µκ°„μ„ κ³µμ ν•λ‹¤λ” μ **μ—μ„ κµ¬μ΅°μ²΄μ™€ ν° μ°¨μ΄κ°€ μλ‹¤.

```c++
#define _CRT_SECURE_NO_WARNINGS    // strcpy λ³΄μ• κ²½κ³ λ΅ μΈν• μ»΄νμΌ μ—λ¬ λ°©μ§€
#include <stdio.h>
#include <string.h>    // strcpy ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ

union Box {    // κ³µμ©μ²΄ μ •μ
    short candy;     // 2λ°”μ΄νΈ
    float snack;     // 4λ°”μ΄νΈ
    char doll[8];    // 8λ°”μ΄νΈ
};

int main()
{
    union Box b1;   // κ³µμ©μ²΄ λ³€μ μ„ μ–Έ

    printf("%d\n", sizeof(b1));  // 8: κ³µμ©μ²΄μ μ „μ²΄ ν¬κΈ°λ” κ°€μ¥ ν° μλ£ν•μ ν¬κΈ°

    strcpy(b1.doll, "bear");     // dollμ— λ¬Έμμ—΄ bear λ³µμ‚¬

    printf("%d\n", b1.candy);    // 25954
    printf("%f\n", b1.snack);    // 4464428256607938511036928229376.000000
    printf("%s\n", b1.doll);     // bear

    return 0;
}
```

μ„μ μμ‹μ—μ„ κ°’μ„ μ΄κΈ°ν™”ν• b1.dollμ„ μ μ™Έν• λ‹¤λ¥Έ λ©¤λ²„λ“¤μ κ°’μ€ μ—‰λ§μ΄λ‹¤. μ΄λ” λ¨λ“  λ©¤λ²„λ“¤μ΄ κ°€μ¥ ν° μλ£ν•μ λ©”λ¨λ¦¬λ¥Ό κ³µμ ν•κΈ° λ•λ¬Έμ΄λ‹¤. μ–΄λ ν• λ©¤λ²„μ— κ°’μ΄ μ €μ¥λλ©΄ λ‚λ¨Έμ§€ λ©¤λ²„λ” κ°’μ„ μ‚¬μ©ν•  μ μ—†λ‹¤. **λ”°λΌμ„ κ³µμ©μ²΄μ λ©¤λ²„λ” ν•λ²μ— ν•λ‚μ”© μ“°λ©΄ μ •μƒμ μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.**

```c++
b1.candy = 10;
printf("%d\n", b1.candy);    // 10: μ‚¬μ©(μ¶λ ¥)

b1.snack = 60000.0f;
printf("%f\n", b1.snack);    // 60000.00000000: μ‚¬μ©(μ¶λ ¥)

strcpy(b1.doll, "bear");
printf("%s\n", b1.doll);     // bear: μ‚¬μ©(μ¶λ ¥)
```

κ³µμ©μ²΄λ” μ—¬λ¬ λ©¤λ²„μ— λ™μ‹μ— μ ‘κ·Όν•μ§€ μ•λ” κ²½μ° κ°™μ€ λ©”λ¨λ¦¬ λ μ΄μ•„μ›ƒμ— λ©¤λ²„λ¥Ό λ¨μ•„λ‘ λ• μ‚¬μ©ν•λ‹¤. νΉν κ³µμ©μ²΄λ” μ„λ² λ””λ“ μ‹μ¤ν…μ΄λ‚ μ»¤λ„ λ¨λ“ λ””λ°”μ΄μ¤ λ“λΌμ΄λ²„ λ“±μ—μ„ μ£Όλ΅ μ‚¬μ©ν•λ©° λ³΄ν†µμ€ κ±°μ μ“°μ§€ μ•λ”λ‹¤.

## κ³µμ©μ²΄μ™€ μ—”λ””μ–Έ

```c++
#include <stdio.h>

union Data {    // κ³µμ©μ²΄ μ •μ
    char c1;
    short num1;
    int num2;
};

int main()
{
    union Data d1;    // κ³µμ©μ²΄ λ³€μ μ„ μ–Έ

    d1.num2 = 0x12345678;    // λ¦¬ν‹€ μ—”λ””μ–Έμ—μ„λ” λ©”λ¨λ¦¬μ— μ €μ¥λ  λ• 78 56 34 12λ΅ μ €μ¥λ¨

    printf("0x%x\n", d1.num2);    // 0x12345678: 4λ°”μ΄νΈ μ „μ²΄ κ°’ μ¶λ ¥
    printf("0x%x\n", d1.num1);    // 0x5678: μ•μ 2λ°”μ΄νΈ κ°’λ§ μ¶λ ¥
    printf("0x%x\n", d1.c1);      // 0x78: μ•μ 1λ°”μ΄νΈ κ°’λ§ μ¶λ ¥

    printf("%d\n", sizeof(d1));   // 4: κ³µμ©μ²΄μ μ „μ²΄ ν¬κΈ°λ” κ°€μ¥ ν° μλ£ν•μ ν¬κΈ°

    return 0;
}
```

μ„ μμ‹λ¥Ό λ³΄λ©΄ d1.num2λ¥Ό μ μ™Έν•κ³  λ‚λ¨Έμ§€ λ©¤λ²„λ“¤μ€ μ €μ¥λ κ°’μ μΌλ¶€λ§ κ°€μ Έμ¤κ³  μλ‹¤. μ΄λ” λ©¤λ²„λ“¤μ΄ ν• μ €μ¥μ†λ¥Ό κ³µμ ν•κ³  μκΈ° λ•λ¬Έμ΄λ‹¤. νΉν μΌλ¶€ κ°’μ΄ λ’¤μ—μ„λ¶€ν„° κ°€μ Έμ™€μ§€κ³  μλ”λ° μ΄λ” **λ¦¬ν‹€μ—”λ””μ–Έ** μ €μ¥ λ°©μ‹ λ•λ¬Έμ΄λ‹¤.

π’΅ λ¦¬ν‹€ μ—”λ””μ–Έμ΄λ€?
λ°μ΄ν„°λ¥Ό 1λ°”μ΄νΈμ”© μΌκ° λ‚®μ€ μλ¦Ώμλ¥Ό μ•μ— λ°°μΉν•λ” μ €μ¥λ°©μ‹μ΄λ‹¤. μ΄μ™€ λ°λ€λ΅ λ°μ΄ν„°μ μμ„λ€λ΅ μ €μ¥ν•λ” λ°©μ‹μ„ λΉ…μ—”λ””μ–Έμ΄λΌκ³  ν•λ‹¤.

## typedefμ™€ κ³µμ©μ²΄

κ³µμ©μ²΄λ„ κµ¬μ΅°μ²΄μ™€ λ§μ°¬κ°€μ§€λ΅ typedefλ΅ λ³„μΉ­μ„ λ¶™μΌ μ μλ‹¤.

```c++
typedef union _Box {    // κ³µμ©μ²΄ μ΄λ¦„μ€ _Box
    short candy;
    float snack;
    char doll[8];
} Box;
```

κ³µμ©μ²΄λ” μ •μν•λ” λ™μ‹μ— λ³€μ μ„ μ–Έμ΄ κ°€λ¥ν•λ‹¤.

```c++
union Box {    // κ³µμ©μ²΄ μ •μ
    short candy;
    float snack;
    char doll[8];
} b1;          // κ³µμ©μ²΄λ¥Ό μ •μν•λ” λ™μ‹μ— λ³€μ b1 μ„ μ–Έ
```

## κ³µμ©μ²΄ ν¬μΈν„°

κ³µμ©μ²΄λ„ ν¬μΈν„°λ΅ μ„ μ–Έν•  μ μμΌλ©° mallocν•¨μλ΅ λ™μ  λ©”λ¨λ¦¬λ¥Ό ν• λ‹Ήν•  μ μλ‹¤.

```c++
#define _CRT_SECURE_NO_WARNINGS     // strcpy λ³΄μ• κ²½κ³ λ΅ μΈν• μ»΄νμΌ μ—λ¬ λ°©μ§€
#include <stdio.h>
#include <stdlib.h>    // malloc, free ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ
#include <string.h>    // strcpy ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ

union Box {    // κ³µμ©μ²΄ μ •μ
    short candy;
    float snack;
    char doll[8];
};

int main()
{
    union Box *b1 = malloc(sizeof(union Box));    // κ³µμ©μ²΄ ν¬μΈν„° μ„ μ–Έ, λ©”λ¨λ¦¬ ν• λ‹Ή

    printf("%d\n", sizeof(union Box));    // 8: κ³µμ©μ²΄μ μ „μ²΄ ν¬κΈ°λ” κ°€μ¥ ν° μλ£ν•μ ν¬κΈ°

    strcpy(b1->doll, "bear");     // dollμ— λ¬Έμμ—΄ bear λ³µμ‚¬

    printf("%d\n", b1->candy);    // 25954
    printf("%f\n", b1->snack);    // 4464428256607938511036928229376.000000
    printf("%s\n", b1->doll);     // bear

    free(b1);    // λ™μ  λ©”λ¨λ¦¬ ν•΄μ 

    return 0;
}

// κ³µμ©μ²΄ ν¬μΈν„°μ™€ κ³µμ©μ²΄λ³€μ μ‚¬μ©
int main()
{
    union Box b1;      // κ³µμ©μ²΄ λ³€μ μ„ μ–Έ
    union Box *ptr;    // κ³µμ©μ²΄ ν¬μΈν„° μ„ μ–Έ

    ptr = &b1;    // b1μ λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό κµ¬ν•μ—¬ ptrμ— ν• λ‹Ή

    strcpy(ptr->doll, "bear");     // dollμ— λ¬Έμμ—΄ bear λ³µμ‚¬

    printf("%d\n", ptr->candy);    // 25954
    printf("%f\n", ptr->snack);    // 4464428256607938511036928229376.000000
    printf("%s\n", ptr->doll);     // bear

    return 0;
}
```
