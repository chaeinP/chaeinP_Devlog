---
title: C_ν¬μΈν„° μ—°μ‚°
date: '2021-10-02'
tags: ['C']
draft: false
summary: ν¬μΈν„°λ” μ—°μ‚°μ„ ν•λ©΄ μ–΄λ–¤ κ°’μ΄ λ‚μ¬κΉ
---

> μ΄ ν¬μ¤νΈλ” [μ½”λ”© λ„μ¥-Cμ–Έμ–΄](https://dojang.io)μ„ λ³΄κ³  μ •λ¦¬ν• study log μ…λ‹λ‹¤. λ³΄λ‹¤ μμ„Έν• λ‚΄μ©μ€ λ§ν¬μ—μ„ ν™•μΈν•μ‹¤ μ μμµλ‹λ‹¤.

## ν¬μΈν„° μ—°μ‚°

ν¬μΈν„° λ³€μμ—λ” λ©”λ¨λ¦¬ μ£Όμ†κ°€ λ“¤μ–΄μλ‹¤. ν¬μΈν„° λ³€μμ— μ–΄λ–¤ μ«μλ¥Ό λ”ν•κ±°λ‚ λΉΌλ©΄ λ©”λ¨λ¦¬ μ£Όμ†κ°€ μ¦κ°€ν•κ±°λ‚ κ°μ†ν•λ‹¤. μ¦‰, **ν¬μΈν„° μ—°μ‚°μ„ ν•λ©΄ λ‹¤λ¥Έ λ©”λ¨λ¦¬ μ£Όμ†μ— μ ‘κ·Όν•  μ μμΌλ©° λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό μ†μ‰½κ² μ®κ²¨λ‹¤λ‹ μ μλ‹¤.**

```c++
#include <stdio.h>

int main()
{
    int numArr[5] = { 11, 22, 33, 44, 55 };
    int *numPtrA;
    int *numPtrB;
    int *numPtrC;

    numPtrA = numArr;    // λ°°μ—΄ μ²« λ²μ§Έ μ”μ†μ λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό ν¬μΈν„°μ— μ €μ¥

    numPtrB = numPtrA + 1;    // ν¬μΈν„° μ—°μ‚°
    numPtrC = numPtrA + 2;    // ν¬μΈν„° μ—°μ‚°

    printf("%p\n", numPtrA);    // 00A3FC00: λ©”λ¨λ¦¬ μ£Όμ†. μ»΄ν“¨ν„°λ§λ‹¤, μ‹¤ν–‰ν•  λ•λ§λ‹¤ λ‹¬λΌμ§
    printf("%p\n", numPtrB);    // 00A3FC04: sizeof(int) * 1μ΄λ―€λ΅ numPtrAμ—μ„ 4κ°€ μ¦κ°€ν•¨
    printf("%p\n", numPtrC);    // 00A3FC08: sizeof(int) * 2μ΄λ―€λ΅ numPtrAμ—μ„ 8μ΄ μ¦κ°€ν•¨

    return 0;
}
```

ν¬μΈν„°λ” μ„ μ–Έλ μλ£ν•μ ν¬κΈ°μ λ°°μλ΅ μ¦κ°ν•λ‹¤. μ„μ μμ—μ„ ν¬μΈν„°λ” λ¨λ‘ intλ΅ μ„ μ–Έλμ–΄ 4λ°”μ΄νΈλ§νΌ μ£Όμ†κ°€ λ‹¬λΌμ§€κ³  μλ‹¤.

char, short, long long μλ£ν• ν¬μΈν„°λ¥Ό μ—°μ‚°ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

```c++
#include <stdio.h>

int main()
{
    char *cPtr1 = NULL;
    short *numPtr1 = NULL;
    long long *numPtr2 = NULL;

    printf("%p\n", cPtr1 + 1);      // 00000001: 0x000000μ—μ„ 1λ°”μ΄νΈλ§νΌ μλ°©ν–¥μΌλ΅ μ΄λ™
    printf("%p\n", numPtr1 + 1);    // 00000002: 0x000000μ—μ„ 2λ°”μ΄νΈλ§νΌ μλ°©ν–¥μΌλ΅ μ΄λ™
    printf("%p\n", numPtr2 + 1);    // 00000008: 0x000000μ—μ„ 8λ°”μ΄νΈλ§νΌ μλ°©ν–¥μΌλ΅ μ΄λ™

    return 0;
}
```

ν¬μΈν„° μ—°μ‚°μ„ μ—­μ°Έμ΅°ν•λ©΄ ν•΄λ‹Ή λ©”λ¨λ¦¬μ— μ ‘κ·Όν•΄ κ°’μ„ κ°€μ Έμ¬ μ μλ‹¤.

```c++
#include <stdio.h>

int main()
{
    int numArr[5] = { 11, 22, 33, 44, 55 };
    int *numPtrA;
    int *numPtrB;
    int *numPtrC;

    numPtrA = numArr;    // λ°°μ—΄ μ²« λ²μ§Έ μ”μ†μ μ£Όμ†λ¥Ό ν¬μΈν„°μ— μ €μ¥

    numPtrB = numPtrA + 1;    // ν¬μΈν„° μ—°μ‚°. numPtrA + 4λ°”μ΄νΈ
    numPtrC = numPtrA + 2;    // ν¬μΈν„° μ—°μ‚°. numPtrA + 8λ°”μ΄νΈ

    printf("%d\n", *numPtrB);    // 22: μ—­μ°Έμ΅°λ΅ κ°’μ„ κ°€μ Έμ΄, numArr[1]κ³Ό κ°™μ
    printf("%d\n", *numPtrC);    // 33: μ—­μ°Έμ΅°λ΅ κ°’μ„ κ°€μ Έμ΄, numArr[2]μ™€ κ°™μ

    return 0;
}
```

μ¦κ° μ—°μ‚°μλ„ μ‚¬μ©ν•  μ μλ‹¤.

```c++
#include <stdio.h>

int main()
{
    int numArr[5] = { 11, 22, 33, 44, 55 };
    int *numPtrA;
    int *numPtrB;
    int *numPtrC;

    numPtrA = &numArr[2];    // λ°°μ—΄ μ„Έ λ²μ§Έ μ”μ†μ μ£Όμ†λ¥Ό ν¬μΈν„°μ— μ €μ¥

    numPtrB = numPtrA;
    numPtrC = numPtrA;

    printf("%d\n", *(++numPtrB));    // 44: numPtrAμ—μ„ μλ°©ν–¥μΌλ΅ 4λ°”μ΄νΈλ§νΌ λ–¨μ–΄μ§„
                                     // λ©”λ¨λ¦¬ μ£Όμ†μ— μ ‘κ·Ό
    printf("%d\n", *(--numPtrC));    // 22: numPtrAμ—μ„ μ—­λ°©ν–¥μΌλ΅ 4λ°”μ΄νΈλ§νΌ λ–¨μ–΄μ§„
                                     // λ©”λ¨λ¦¬ μ£Όμ†μ— μ ‘κ·Ό

    return 0;
}
```

μ—¬κΈ°μ„ μ£Όμν•  μ μ€ _(++numPtrB)κ³Ό _(numPtrB++)λ” κ°’μ΄ λ‹¤λ¥΄λ‹¤λ” κ²ƒμ΄λ‹¤. μ „μλ” 44κ°€ μ¶λ ¥λμ§€λ§ ν›„μλ” μ¶λ ¥ μ΄ν›„ μ—°μ‚°μ΄ μ§„ν–‰λκΈ° λ•λ¬Έμ— 33μ΄ λ‚μ¨λ‹¤.

## void ν¬μΈν„° μ—°μ‚°

void ν¬μΈν„°λ” μλ£ν•μ ν¬κΈ°κ°€ μ •ν•΄μ Έ μμ§€ μ•κΈ° λ•λ¬Έμ— +, -λ΅ μ—°μ‚°μ„ ν•΄λ„ μ–Όλ§λ§νΌ μ΄λ™ν• μ§€ μ• μκ°€ μ—†λ‹¤. λ”°λΌμ„ void ν¬μΈν„°λ” ν¬μΈν„° μ—°μ‚°μ„ ν•  μ μ—†λ‹¤. λ§μ•½ void ν¬μΈν„°λ΅ ν¬μΈν„° μ—°μ‚°μ„ ν•κ³  μ‹¶λ‹¤λ©΄ λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ μ—°μ‚°μ„ ν•΄μ•Όν•λ‹¤.

```c++
#include <stdio.h>
#include <stdlib.h>    // malloc, free ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ

int main()
{
    void *ptr = malloc(100);    // 100λ°”μ΄νΈλ§νΌ λ©”λ¨λ¦¬ ν• λ‹Ή

    printf("%p\n", ptr);               // 00FADD20: λ©”λ¨λ¦¬ μ£Όμ†. μ»΄ν“¨ν„°λ§λ‹¤, μ‹¤ν–‰ν•  λ•λ§λ‹¤ λ‹¬λΌμ§
    printf("%p\n", (int *)ptr + 1);    // 00FADD24: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°
    printf("%p\n", (int *)ptr - 1);    // 00FADD1C: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°

    void *ptr2 = ptr;    // λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό λ³€ν™”μ‹ν‚¬ λ•λ” λ‹¤λ¥Έ ν¬μΈν„°μ— λ³΄κ΄€
    printf("%p\n", ++(int *)ptr2);     // 00FADD24: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°
    printf("%p\n", --(int *)ptr2);     // 00FADD20: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°

    printf("%p\n", ((int *)ptr2)++);   // 00FADD20: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°
    printf("%p\n", ((int *)ptr2)--);   // 00FADD24: λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν• λ’¤ ν¬μΈν„° μ—°μ‚°

    free(ptr);

    return 0;
}
```

> β—οΈλ™μ  λ©”λ¨λ¦¬λ¥Ό ν• λ‹Ήλ°›μ€ ν¬μΈν„°λ¥Ό ++, -- μ—°μ‚°μλ΅ ν¬μΈν„° μ—°μ‚°μ„ ν•κ² λλ©΄ ν¬μΈν„°μ— μ €μ¥λ λ©”λ¨λ¦¬ μ£Όμ† μμ²΄κ°€ λ°”λ€κ² λλ‹¤. μ΄λ• free ν•¨μμ—μ„ λ©”λ¨λ¦¬ μ£Όμ†κ°€ λ°”λ€ ν¬μΈν„°λ΅ λ©”λ¨λ¦¬ ν•΄μ λ¥Ό ν•λ©΄ μ—λ¬κ°€ λ°μƒν•λ―€λ΅ μ£Όμν•©λ‹λ‹¤. λ”°λΌμ„ λ©”λ¨λ¦¬ μ£Όμ†κ°€ λ°”λ€λ” μ—°μ‚°μ€ λ‹¤λ¥Έ ν¬μΈν„°μ— μ£Όμ†λ¥Ό λ³΄κ΄€ν•μ—¬ μν–‰ν•λ‹¤.

void ν¬μΈν„°λ¥Ό ν¬μ–Έν„° μ—°μ‚°ν• λ’¤ μ—­μ°Έμ΅° ν•λ ¤λ©΄ λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν•μ—¬ μ—°μ‚°ν• λ’¤ μ—°μ‚° μ „μ²΄λ¥Ό κ΄„νΈλ΅ λ¬¶κ³  μ•μ— μ—­μ°Έμ΅° μ—°μ‚°μ(\*)λ¥Ό μ¶”κ°€ν•λ‹¤.

```c++
#include <stdio.h>

int main()
{
    int numArr[5] = { 11, 22, 33, 44, 55 };
    void *ptr = &numArr[2];    // λ‘ λ²μ§Έ μ”μ†μ λ©”λ¨λ¦¬ μ£Όμ†

    printf("%d\n", *(int *)ptr);    // 33: ν¬μΈν„° μ—°μ‚°μ„ ν•μ§€ μ•μ€ μƒνƒμ—μ„ μ—­μ°Έμ΅°

    // void ν¬μΈν„°λ¥Ό λ‹¤λ¥Έ ν¬μΈν„°λ΅ λ³€ν™ν•μ—¬ ν¬μΈν„° μ—°μ‚°μ„ ν• λ’¤ μ—­μ°Έμ΅°
    printf("%d\n", *((int *)ptr + 1));    // 44
    printf("%d\n", *((int *)ptr - 1));    // 22

    printf("%d\n", *(++(int *)ptr));      // 44
    printf("%d\n", *(--(int *)ptr));      // 33

    printf("%d\n", *(((int *)ptr)++));    // 33
    printf("%d\n", *(((int *)ptr)--));    // 44

    return 0;
}
```

π’΅ λ§μ΄ν¬λ΅μ†ν”„νΈ μ „μ© μ–Έμ–΄ ν™•μ¥
λ³€μμ μλ£ν•μ„ λ‹¤λ¥Έ μλ£ν•μΌλ΅ λ³€ν™ν™ λ’¤ λ³€μμ κ°’μ„ λ³€κ²½ν•λ”κ²ƒμ€ λ§μ΄ν¬λ΅μ†ν”„νΈ μ „μ© μ–Έμ–΄ ν™•μ¥μ΄λ‹¤. λ”°λΌμ„ GCCμ—μ„ μ»΄νμΌν•λ ¤λ©΄ ν¬μΈν„°λ¥Ό λ‹¤λ¥Έ μλ£ν•μ ν¬μΈν„°μ— ν• λ‹Ήν• λ’¤ μ—°μ‚°μλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.

```c++
void *ptr = malloc(100);

int *ptr2 = ptr;    // void ν¬μΈν„°λ¥Ό int ν¬μΈν„°μ— ν• λ‹Ή
printf("%p\n", ++ptr2);
printf("%p\n", --ptr2);

printf("%d\n", *(++ptr2));
printf("%d\n", *(--ptr2));

free(ptr);
```

## κµ¬μ΅°μ²΄ ν¬μΈν„° μ—°μ‚°

```c++
#include <stdio.h>
#include <stdlib.h>    // malloc, free ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ
#include <string.h>    // memcpy ν•¨μκ°€ μ„ μ–Έλ ν—¤λ” νμΌ

struct Data {
    int num1;
    int num2;
};

int main()
{
    void *ptr = malloc(sizeof(struct Data) * 3);    // κµ¬μ΅°μ²΄ 3κ° ν¬κΈ°λ§νΌ λ™μ  λ©”λ¨λ¦¬ ν• λ‹Ή
    struct Data d[3];

    ((struct Data *)ptr)->num1 = 10;        // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥
    ((struct Data *)ptr)->num2 = 20;        // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥

    ((struct Data *)ptr + 1)->num1 = 30;    // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥
    ((struct Data *)ptr + 1)->num2 = 40;    // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥

    ((struct Data *)ptr + 2)->num1 = 50;    // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥
    ((struct Data *)ptr + 2)->num2 = 60;    // ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ— κ°’ μ €μ¥

    memcpy(d, ptr, sizeof(struct Data) * 3);    // λ™μ  λ©”λ¨λ¦¬κ°€ κµ¬μ΅°μ²΄ λ°°μ—΄μ ν•νƒμ™€ κ°™μ€μ§€
                                    // ν™•μΈν•κΈ° μ„ν•΄ λ™μ  λ©”λ¨λ¦¬μ λ‚΄μ©μ„ κµ¬μ΅°μ²΄ λ°°μ—΄μ— λ³µμ‚¬

    printf("%d %d\n", d[1].num1, d[1].num2);    // 30 40: κµ¬μ΅°μ²΄ λ°°μ—΄μ λ©¤λ²„ μ¶λ ¥
    printf("%d %d\n", ((struct Data *)ptr + 2)->num1, ((struct Data *)ptr + 2)->num2);
                                                // 50 60: ν¬μΈν„° μ—°μ‚°μΌλ΅ λ©”λ¨λ¦¬μ κ°’ μ¶λ ¥

    free(ptr);    // λ™μ  λ©”λ¨λ¦¬ ν•΄μ 

    return 0;
}
```
