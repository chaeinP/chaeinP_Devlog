---
title: Nodejs_좋은 로그란 무엇일까?
date: '2021-11-16'
tags: ['NODEJS', 'TYPESCRIPT']
draft: false
summary: 백엔드에서 중요한 로그 기능 구현하기(1)
---

## 로그란?

로그 데이터는 서비스를 운영하면서 생기는 모든 행위를 기록으로 남긴 데이터를 의미한다. 클라이언트에서 발생한 로그는 고객의 행동 패턴을 유추하는데 주로 사용되는 반면 백엔드에서 발생한 로그는 서버에서 발생한 이상 징후나 패턴을 찾을 때 주로 사용한다. IT회사의 대부분의 데이터는 로그 데이터라고 보아도 무방하다. 따라서 방대한 양이 기록되는 만큼 반드시 필요한 정보가 무엇인지를 잘 설계해 로그를 기록하는 것이 중요하다.

## 로그 레벨

- trace level

  프로덕션 모드에서는 절대 돌아가서는 안되는 코드이다. 개발자가 개발 단계에서 디버깅을 위해 사용하는 로그이며 커밋 전에는 삭제해주는 것이 좋다.

- debug level

  프로그램에서 생기는 모든 일을 기록한다. 주로 디버깅을 위해 사용되며 배포 전에는 꼭 필요한 로그만 남겨놓는 것이 좋다.

- info level

  사용자의 동자/요청으로 발생하는 이벤트를 기록한다.

- notice level

  프로덕션 모드에서도 출력되어야 하는 메세지중 에러가 아닌 것만을 기록한다.

- error level

  내부에서 발생하는 모든 에러를 기록한다.

- fatal level

  프로그램에서 절대 찍혀선 안되는 로그에 해당한다. 보통 프로그램이 죽기 직전 이 로그를 찍고 바로 죽는다.

로그 레벨은 레벨을 나누는 절대적 기준이 없으므로 프로그래머에 따라 모호하게 사용될 수 있다. 또한 개발 시에 모든 로그 레벨의 로그가 찍힐 필요도 없다. 만약 TDD기반으로 개발을 진행한다면 trace/debug 레벨의 로그는 애초에 필요하지 않다고 보는 시각도 있다. fatal 레벨의 경우 프로그램이 죽기 전 해당 로그가 찍히지 않을 가능성이 다분해 error 레벨에서 모두 관리하는 경우도 있다고 한다. 로그 아키텍쳐를 설계할 시에 프로젝트에 반드시 필요한 로그와 목적을 명확히 하는 것이 중요해보인다.

## 좋은 로그란?

- 로그는 로그 한 줄을 가지고도 모든 것을 복구할 수 있을 정도로 자세하게 작성되어야 한다.
- 로그 메세지는 로그가 발생한 상황을 추론하지 않고도 충분히 이해할 수 있을 정도로 메세지에 주변 상황과 해당 명령의 의도, 기대하는 결과물을 구체적으로 작성한다.
- 각 로그는 독립적이어야 한다. 이전 로그에 의존하는 상태로 작성하면 비동기, 멀티 스레딩 환경에서는 순서가 꼬여 tracking이 어려워질 수 있다.

## 로그 작성시 주의사항

- 로그 파일/DB 생명주기 & 저장소 용량을 고려하여 설계한다. 기록된 로그는 얼마나 보관할지 용량은 어느정도로 할지를 명확하게 계획하고 운영해야 용량 부족과 같은 갑작스런 장애를 방지할 수 있다.
- 개인 정보, 시스템 주요 정보(보안 정보, 계정 정보)등 민감 정보가 로그에 기록되지 않도록 주의해야한다. 법적으로 문제가 될 수도 있다.

참고자료

- [좋은 로그란 무엇인가?](https://velog.io/@zzzz465/%EC%A2%8B%EC%9D%80-%EB%A1%9C%EA%B7%B8%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80)
- [좋은 로그를 위해 고려해야할 것들](https://speakerdeck.com/devinjeon/jamag-ndc19-joheun-rogeuran-mueosinga-joheun-rogeureul-wihae-goryeohaeya-hal-geosdeul)
- [무엇을 로그로 작성할까?](https://blog.lulab.net/programmer/what-should-i-log-with-an-intention-method-and-level/)
